#pragma once

////////////////////////////////////////////////////////////////////////////////
// REngine Base
////////////////////////////////////////////////////////////////////////////////
#include <REngine/Core/ReCoreBase>
////////////////////////////////////////////////////////////////////////////////
// System headers
////////////////////////////////////////////////////////////////////////////////
#include <Windows.h>
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
NAMESPACE_BEGIN (REngine::Core)
////////////////////////////////////////////////////////////////////////////////

// Handle class
template <typename ObjectHandleTraits>
class ObjectHandle
{
  using HandleType = typename ObjectHandleTraits::HandleType;

 public:
  explicit ObjectHandle (
    HandleType handle = ObjectHandleTraits::InvalidHandle ());
  ~ObjectHandle ();

 public:
  ObjectHandle (const ObjectHandleTraits& other) = delete;

 public:
  const ObjectHandle& operator= (const ObjectHandleTraits& other) = delete;

 public:
  void Close () noexcept;

 private:
  HandleType handle;
};

// Handle traits
struct InvalidValueHandleTraits
{
  using HandleType = HANDLE;

  static void Close (HandleType handle) noexcept;
  static auto Invalid () noexcept -> HandleType;
};

struct NullptrHandleTraits
{
  using HandleType = HANDLE;

  static void Close (HandleType handle) noexcept;
  static auto Invalid () noexcept -> HandleType;
};

struct WindowHandleTraits
{
  using HandleType = HWND;

  static void Close (HandleType handle) noexcept;
  static auto Invalid () noexcept -> HandleType;
};

////////////////////////////////////////////////////////////////////////////////
NAMESPACE_END (REngine::Core)
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Inline methods
////////////////////////////////////////////////////////////////////////////////
#include "ObjectHandle.inl"
////////////////////////////////////////////////////////////////////////////////
